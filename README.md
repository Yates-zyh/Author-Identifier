# Author Style Analyzer

A comprehensive system for author style analysis, identification, and text generation based on specific author styles.

## Overview

This project provides tools to analyze writing styles, identify authors of given texts, and generate new text in the style of specific authors. It uses state-of-the-art natural language processing techniques, including BERT for author classification and specialized models for style-based text generation with DeepSeek API integration for comparison.

## Features

- **Author Style Training**: Train models to recognize the writing styles of different authors
- **Author Identification**: Analyze text samples to identify their likely authors
- **Style-based Text Generation**: Generate new text that mimics the style of specific authors
- **Author Style Comparison**: Compare texts generated by different models
- **Interactive Streamlit GUI**: User-friendly web interface for all functionality
- **Chatbot Integration**: Interact with the style generator through a conversational interface
- **API Integration**: Comparison with DeepSeek API for style generation

## Getting Started

The primary entry point for this application is the **GUI_streamlit.py** file, which provides a user-friendly interface to access all the system's functionality.

### Launch the GUI Application

```
streamlit run GUI_streamlit.py
```

After running this command, a browser window will open with the application interface at http://127.0.0.1:8501

### Using the GUI

The GUI provides five main tabs:

1. **Style Analysis**: Upload or paste text to identify the likely author based on writing style
2. **Custom Model**: Generate text in the style of a specific author using our fine-tuned models
3. **DeepSeek Model**: Generate text using the DeepSeek API for comparison
4. **Model Comparison**: Compare texts generated by different models side by side
5. **About**: Information about the project and configuration status

## Project Structure

- `GUI_streamlit.py`: **Main entry point** - Streamlit web interface for all functionality
- `identify.py`: Core module for identifying authors from text samples
- `generate_with_chatbot.py`: Text generation functionality with chatbot integration
- `train.py`: Script for training the author style classification model
- `trainseq.py`: Sequential training pipeline for author style models
- `validate.py`: Module for validating model performance
- `tools/`: Utility scripts for data preparation and model management
- `data_train/`: Directory containing training text samples from various authors
- `data_val/`: Directory containing validation text samples from the same authors
- `visualizations/`: Output directory for training history visualizations
- `docker-compose.yml` & `Dockerfile`: Container configuration (in progress)

## Data Structure

The project uses a structured dataset of author works organized as follows:

```
data_train/
  ├── Agatha_Christie/
  │   ├── Poirot Investigates.txt
  │   ├── The murder of Roger Ackroyd.txt
  │   └── ...
  ├── Alexandre_Dumas/
  │   ├── The black tulip.txt
  │   └── ...
  └── ...

data_val/
  ├── Agatha_Christie/
  │   ├── The Big Four.txt
  │   └── ...
  └── ...
```

## Requirements

- Python 3.7+
- PyTorch
- Transformers (Hugging Face)
- NLTK
- Streamlit
- scikit-learn
- tqdm
- OpenAI (for API integration)

## Installation

1. Clone the repository:
   ```
   git clone git@github.com:Yates-zyh/Author-Identifier.git
   ```

2. Install required packages:
   ```
   pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu126
   pip install -e .
   ```

3. Install additional dependencies:
   ```
   pip install streamlit openai
   ```

## API Usage

If you prefer to use the system programmatically instead of through the GUI, the following code examples demonstrate how to use the core functionality:

### Author Style Analysis

Analyze text to identify the potential author:

```python
from identify import AuthorIdentifier

identifier = AuthorIdentifier()
result = identifier.analyze_text("Your text here", confidence_threshold=0.6)
print(f"Predicted author: {result['predicted_author']}")
print(f"Confidence: {result['confidence']:.2f}")
```

### Text Generation

Generate text in the style of a specific author:

```python
from chatbot_with_generator import AuthorStyleAPI

api = AuthorStyleAPI(token="your_huggingface_token")
samples = api.generate_text(author="Mark_Twain", num_samples=1, max_length=200)
print(samples[0])
```

## Configuration

For optimal performance, configure API tokens in a `.env` file:

```
GENERATION_TOKEN=your_huggingface_token
OPENAI_API_KEY=your_deepseek_api_key
IDENTIFICATION_TOKEN=your_huggingface_token
```

## Training New Models

Train a new author identification model:

```
python train.py --data_dir data_train --val_dir data_val --epochs 5
```

Train sequentially:

```
python trainseq.py --authors Agatha_Christie Jane_Austen --epochs 3
```

## Validation

Validate model performance:

```
python validate.py --model_path models/author_identifier_model.pth
```

## Docker (Coming Soon)

Docker configuration is in progress. The following will be supported in future releases:

```
docker-compose up -d
```

## Model Details

The system uses:
- **BERT** fine-tuned for author style classification
- **GPT-2** based models for generating text in specific author styles
- Integration with **DeepSeek API** for comparison and enhanced text generation

## Supported Authors

The current version supports the following authors:
- Agatha Christie
- Alexandre Dumas
- Arthur Conan Doyle
- Charles Dickens
- Charlotte Brontë
- F. Scott Fitzgerald
- García Márquez
- Herman Melville
- Jane Austen
- Mark Twain

## Acknowledgments

- This project was developed as part of the EBA5004 Practical Language Processing course.
- Thanks to the Hugging Face team for their Transformers library.
- Thanks to DeepSeek for providing API access for comparison models.
